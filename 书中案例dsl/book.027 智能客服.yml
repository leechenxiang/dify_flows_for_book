app:
  description: ''
  icon: moyai
  icon_background: '#ECE9FE'
  mode: advanced-chat
  name: book.027 æ™ºèƒ½å®¢æœ
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/tongyi:0.0.14@d333909fe8d75a335b44da4b878d5120779b8703f12c21cf4730135d6864afbb
kind: app
version: 0.2.0
workflow:
  conversation_variables:
  - description: è®¢å•å·
    id: db2fbe91-b662-4d1c-ad5a-3c4108545746
    name: orderId
    selector:
    - conversation
    - orderId
    value: 0
    value_type: number
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: 'æ¬¢è¿è¿›å…¥æ™ºèƒ½å®¢æœï¼æˆ‘å¯ä»¥å¸®æ‚¨ï¼š

      ğŸ’ æŸ¥è¯¢è®¢å•

      ğŸ’ è§£ç­”äº§å“é—®é¢˜

      ğŸ’ å”®åé—®é¢˜

      è¯·å‘Šè¯‰æˆ‘æ‚¨çš„éœ€æ±‚ï¼'
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        sourceType: llm
        targetType: answer
      id: llm-answer
      selected: false
      source: llm
      sourceHandle: source
      target: answer
      targetHandle: target
      type: custom
    - data:
        isInIteration: false
        sourceType: start
        targetType: question-classifier
      id: 1741784513812-source-1741784565655-target
      selected: false
      source: '1741784513812'
      sourceHandle: source
      target: '1741784565655'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: question-classifier
        targetType: knowledge-retrieval
      id: 1741784565655-2-1741784644955-target
      selected: false
      source: '1741784565655'
      sourceHandle: '2'
      target: '1741784644955'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: knowledge-retrieval
        targetType: llm
      id: 1741784644955-source-llm-target
      selected: false
      source: '1741784644955'
      sourceHandle: source
      target: llm
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: question-classifier
        targetType: if-else
      id: 1741784565655-1-1741786050893-target
      selected: false
      source: '1741784565655'
      sourceHandle: '1'
      target: '1741786050893'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: knowledge-retrieval
        targetType: llm
      id: 1741787109469-source-1741787118736-target
      selected: false
      source: '1741787109469'
      sourceHandle: source
      target: '1741787118736'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: llm
        targetType: answer
      id: 1741787118736-source-1741787229518-target
      selected: false
      source: '1741787118736'
      sourceHandle: source
      target: '1741787229518'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        sourceType: question-classifier
        targetType: answer
      id: 1741784565655-1741784583805-1741787253734-target
      selected: false
      source: '1741784565655'
      sourceHandle: '1741784583805'
      target: '1741787253734'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: question-classifier
        targetType: knowledge-retrieval
      id: 1741784565655-1741784580388-1741787109469-target
      source: '1741784565655'
      sourceHandle: '1741784580388'
      target: '1741787109469'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 1741786050893-false-1741786078841-target
      source: '1741786050893'
      sourceHandle: 'false'
      target: '1741786078841'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1741786050893-true-1741786546741-target
      source: '1741786050893'
      sourceHandle: 'true'
      target: '1741786546741'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: answer
      id: 1741786546741-source-1741786162042-target
      source: '1741786546741'
      sourceHandle: source
      target: '1741786162042'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: è®¢å•å·
          max_length: 48
          options: []
          required: false
          type: number
          variable: orderId
      height: 89
      id: '1741784513812'
      position:
        x: 30
        y: 320
      positionAbsolute:
        x: 30
        y: 320
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1741784644955'
          - result
        desc: ''
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: false
            size: 10
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: qwen-max
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: 3704af84-443c-44ec-b2a1-119a12d68dba
          role: system
          text: '# è§’è‰²è®¾å®š

            ä½ ä½œä¸ºäº§å“çš„å”®å‰é¡¾é—®ï¼Œéœ€å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š

            1. â€‹**ç²¾å‡†è§£ç­”**ï¼šåŸºäºã€ŒçŸ¥è¯†åº“ã€å†…å®¹å›ç­”äº§å“åŠŸèƒ½ã€é€‚ç”¨åœºæ™¯ã€ä»·æ ¼æ–¹æ¡ˆç­‰é—®é¢˜

            2. â€‹**éœ€æ±‚æŒ–æ˜**ï¼šé€šè¿‡æé—®ç¡®è®¤ç”¨æˆ·é¢„ç®—/ä½¿ç”¨åœºæ™¯/æ ¸å¿ƒéœ€æ±‚

            3. â€‹**æ–¹æ¡ˆæ¨è**ï¼šæ ¹æ®å¯¹è¯ä¸Šä¸‹æ–‡æ¨èæœ€é€‚åˆçš„å¥—é¤æˆ–æœåŠ¡

            4. â€‹**å¼‚è®®å¤„ç†**ï¼šå¯¹â€œä»·æ ¼å¤ªé«˜â€ã€â€œåŠŸèƒ½ä¸è¶³â€ç­‰å¸¸è§å¼‚è®®å‡†å¤‡åº”ç­”è¯æœ¯


            # çŸ¥è¯†åº“ä½¿ç”¨è§„åˆ™

            - ä¼˜å…ˆå¼•ç”¨çŸ¥è¯†åº“æ–‡æ¡£å†…å®¹{{#context#}}

            - å½“çŸ¥è¯†åº“ä¿¡æ¯ä¸æ˜ç¡®æ—¶ï¼Œå›ç­”éœ€åŒ…å«â€œæ ¹æ®å¸¸è§„æƒ…å†µâ€ç­‰ç¼“å†²è¯

            - ç¦æ­¢ç¼–é€ çŸ¥è¯†åº“æœªåŒ…å«çš„æŠ€æœ¯å‚æ•°'
        - id: 5838eba9-4582-4336-9f62-faf481216781
          role: user
          text: ç”¨æˆ·çš„é—®é¢˜æ˜¯{{#sys.query#}}
        selected: false
        title: LLM
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: llm
      position:
        x: 603.7718915297596
        y: 498.1661185409166
      positionAbsolute:
        x: 603.7718915297596
        y: 498.1661185409166
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#llm.text#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 104
      id: answer
      position:
        x: 897.3982075799755
        y: 498.1661185409166
      positionAbsolute:
        x: 897.3982075799755
        y: 498.1661185409166
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        classes:
        - id: '1'
          name: è®¢å•æŸ¥è¯¢
        - id: '2'
          name: å”®å‰é—®é¢˜
        - id: '1741784580388'
          name: å”®åé—®é¢˜
        - id: '1741784583805'
          name: å…¶ä»–
        desc: ''
        instructions: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: qwen-max
          provider: langgenius/tongyi/tongyi
        query_variable_selector:
        - '1741784513812'
        - sys.query
        selected: false
        title: é—®é¢˜åˆ†ç±»å™¨
        topics: []
        type: question-classifier
        vision:
          enabled: false
      height: 247
      id: '1741784565655'
      position:
        x: 30
        y: 433.73818148602595
      positionAbsolute:
        x: 30
        y: 433.73818148602595
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        dataset_ids:
        - Dc33cQaFMNZOQc1sxlEKePtXbyGrblkFyYm+e87Zd3GnV7LKU2bmNvN1DxwltXWr
        desc: ''
        multiple_retrieval_config:
          reranking_enable: true
          reranking_mode: weighted_score
          reranking_model:
            model: gte-rerank
            provider: langgenius/tongyi/tongyi
          top_k: 4
          weights:
            keyword_setting:
              keyword_weight: 0.3
            vector_setting:
              embedding_model_name: text-embedding-v3
              embedding_provider_name: langgenius/tongyi/tongyi
              vector_weight: 0.7
        query_variable_selector:
        - '1741784513812'
        - sys.query
        retrieval_mode: multiple
        selected: false
        title: çŸ¥è¯†æ£€ç´¢
        type: knowledge-retrieval
      height: 91
      id: '1741784644955'
      position:
        x: 317.04020019011847
        y: 498.1661185409166
      positionAbsolute:
        x: 317.04020019011847
        y: 498.1661185409166
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: not empty
            id: d485d7c8-270c-4008-b93f-9f5e58f858dd
            value: ''
            varType: number
            variable_selector:
            - '1741784513812'
            - orderId
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: æ¡ä»¶åˆ†æ”¯
        type: if-else
      height: 125
      id: '1741786050893'
      position:
        x: 317.04020019011847
        y: 320
      positionAbsolute:
        x: 317.04020019011847
        y: 320
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: ä¸ºäº†æ›´å¥½åœ°å¸®æ‚¨æŸ¥è¯¢è®¢å•çŠ¶æ€ï¼Œè¯·æä¾›æ‚¨çš„è®¢å•å·ï¼Œæˆ‘ä¼šç«‹å³ä¸ºæ‚¨å¤„ç†ï¼ğŸ˜Š
        desc: ''
        selected: false
        title: æ²¡æœ‰è®¢å•å·
        type: answer
        variables: []
      height: 117
      id: '1741786078841'
      position:
        x: 603.7718915297596
        y: 339.72117048098465
      positionAbsolute:
        x: 603.7718915297596
        y: 339.72117048098465
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1741786546741.result#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤ 3
        type: answer
        variables: []
      height: 104
      id: '1741786162042'
      position:
        x: 903.7051928720273
        y: 240.96777384224603
      positionAbsolute:
        x: 903.7051928720273
        y: 240.96777384224603
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "\nfunction main({order_id}) {\n\n    const orders = {\n        1001:\
          \ {\n            è®¢å•ç¼–å·: 1001,\n            è®¢å•çŠ¶æ€: \"å·²å®Œæˆ\",\n            äº§å“åç§°:\
          \ \"ç¬”è®°æœ¬ç”µè„‘\",\n            ä»·æ ¼: 8999,\n            è´­ä¹°äºº: \"å¼ ä¸‰\"\n        },\n\
          \        1002: {\n            è®¢å•ç¼–å·: 1002,\n            è®¢å•çŠ¶æ€: \"å¾…å‘è´§\",\n\
          \            äº§å“åç§°: \"æ™ºèƒ½æ‰‹æœº\",\n            ä»·æ ¼: 4999,\n            è´­ä¹°äºº: \"\
          æå››\"\n        },\n        1003: {\n            è®¢å•ç¼–å·: 1003,\n           \
          \ è®¢å•çŠ¶æ€: \"è¿è¾“ä¸­\",\n            äº§å“åç§°: \"æ™ºèƒ½æ‰‹è¡¨\",\n            ä»·æ ¼: 1999,\n \
          \           è´­ä¹°äºº: \"ç‹äº”\"\n        }\n    };\n\n    const order = orders[order_id];\n\
          \    if (order) {\n        var aa = { statusCode: 200, data: order };\n\
          \        return {result: aa};\n    } else {\n        var bb = { statusCode:\
          \ 400, message: \"æŸ¥æ— è®¢å•\" };\n        return {result: bb};\n    }\n\n}\n"
        code_language: javascript
        desc: ''
        outputs:
          result:
            children: null
            type: object
        selected: false
        title: ä»£ç æ‰§è¡Œ
        type: code
        variables:
        - value_selector:
          - '1741784513812'
          - orderId
          variable: order_id
      height: 53
      id: '1741786546741'
      position:
        x: 603.7718915297596
        y: 240.96777384224603
      positionAbsolute:
        x: 603.7718915297596
        y: 240.96777384224603
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        dataset_ids:
        - U43FkFila8UfIYpMKwIkVJ9rY6cuBqLLQoAraUKnL5aRNMK5u3fkJKTh1k4DyPKA
        desc: ''
        multiple_retrieval_config:
          reranking_enable: true
          reranking_mode: weighted_score
          reranking_model:
            model: gte-rerank
            provider: langgenius/tongyi/tongyi
          top_k: 4
          weights:
            keyword_setting:
              keyword_weight: 0.3
            vector_setting:
              embedding_model_name: text-embedding-v3
              embedding_provider_name: langgenius/tongyi/tongyi
              vector_weight: 0.7
        query_variable_selector:
        - '1741784513812'
        - sys.query
        retrieval_mode: multiple
        selected: false
        title: çŸ¥è¯†æ£€ç´¢ 2
        type: knowledge-retrieval
      height: 91
      id: '1741787109469'
      position:
        x: 317.04020019011847
        y: 642.5838283155584
      positionAbsolute:
        x: 317.04020019011847
        y: 642.5838283155584
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1741787109469'
          - result
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: qwen-max
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: b78bb595-a167-4433-9dbc-f254b6aacd45
          role: system
          text: '# è§’è‰²è®¾å®š

            ä½ æ˜¯ä¸€ä¸ªå”®åå®¢æœï¼Œéœ€å®Œæˆï¼š

            1. â€‹**é—®é¢˜å®šä½**ï¼šé€šè¿‡ç”¨æˆ·æè¿°å®šä½æ•…éšœç±»å‹ï¼ˆç¡¬ä»¶/è½¯ä»¶/æ“ä½œå¤±è¯¯ï¼‰

            2. â€‹**çŸ¥è¯†åº“è°ƒç”¨**ï¼šç²¾å‡†åŒ¹é…{{#context#}}çš„å¯¹åº”ç« èŠ‚

            3. â€‹**æƒ…ç»ªå®‰æŠš**ï¼šå¯¹æŠ•è¯‰/æŠ±æ€¨ä½¿ç”¨å…±æƒ…è¯æœ¯ï¼ˆå¦‚â€œéå¸¸ç†è§£æ‚¨çš„å¿ƒæƒ…â€ï¼‰

            4. â€‹**æµç¨‹å¼•å¯¼**ï¼šæ˜ç¡®å‘ŠçŸ¥å¤„ç†æ­¥éª¤åŠæ—¶é—´èŠ‚ç‚¹

            5. **è®¢å•è¯¦æƒ…**ï¼šæ ¹æ®è®¢å•ä¿¡æ¯å‡†ç¡®åˆ†æç”¨æˆ·é—®é¢˜


            # å“åº”è§„èŒƒ

            - æŠ€æœ¯æœ¯è¯­å¿…é¡»è½¬æ¢ä¸ºå°ç™½èƒ½æ‡‚çš„è¯­è¨€ï¼ˆå¦‚â€œä¸»æ¿æ•…éšœâ€æ”¹ä¸ºâ€œè®¾å¤‡æ ¸å¿ƒéƒ¨ä»¶å¼‚å¸¸â€ï¼‰

            - æ¯æ¬¡å›ç­”éœ€åŒ…å«è§£å†³æ–¹æ¡ˆ+é¢„é˜²å»ºè®®

            - ç¦ç”¨â€œä¸å¯èƒ½â€ã€â€œä½ å¼„é”™äº†â€ç­‰å¦å®šæ€§è¡¨è¾¾'
        - id: 6b1c7bcb-c52b-4e6e-ac55-9c3e2edf9bec
          role: user
          text: ç”¨æˆ·çš„é—®é¢˜æ˜¯{{#sys.query#}}
        selected: false
        title: LLM 2
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: '1741787118736'
      position:
        x: 608.1543738588673
        y: 642.5838283155584
      positionAbsolute:
        x: 608.1543738588673
        y: 642.5838283155584
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1741787118736.text#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤ 4
        type: answer
        variables: []
      height: 104
      id: '1741787229518'
      position:
        x: 897.3982075799755
        y: 642.5838283155584
      positionAbsolute:
        x: 897.3982075799755
        y: 642.5838283155584
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: æˆ‘åªèƒ½å›å¤å’Œäº§å“è®¢å•ç›¸å…³çš„é—®é¢˜å“¦~ï¼ğŸ˜
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤ 5
        type: answer
        variables: []
      height: 117
      id: '1741787253734'
      position:
        x: 30
        y: 702.7376657465793
      positionAbsolute:
        x: 30
        y: 702.7376657465793
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: 195.11967477864016
      y: -192.79921576332288
      zoom: 1.1082256932085675
